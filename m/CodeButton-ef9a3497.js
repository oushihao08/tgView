/* empty css             *//* empty css              */import{v as e,a,z as t,_ as s,C as o,q as l,n}from"../js/index-v1.1.28-f4a5fda3.js";import{_ as r}from"./IconSvg-f87608f8.js";import{E as u}from"./index-6c2aa957.js";import{r as c,c as d,M as i,R as p,S as A,j as f,N as m,u as v,L as w,$ as g,y as b,U as h,Z as y,a as C,w as k,b as B,n as _,q as x,_ as I,F as Q}from"./vue-10f3042e.js";import{b as V}from"./vant-f0b40d2b.js";/* empty css                  *//* empty css               */import{f as j}from"./vendor-f8157dbf.js";import{E}from"./index-fc07082a.js";/* empty css                */import{E as D}from"./index-68d61afc.js";import{E as P}from"./index-81717dbd.js";const R=["src"],N={__name:"InputPwd",props:{modelValue:{},placeholder:{},showPwdStrengt:{default:!0},pwdStrengt:{}},setup(t,{emit:s}){const o=t;let l=c("password");const n=()=>{l.value="password"==l.value?"text":"password"},w=d((()=>{let a=1;return e.pwdStrengt.verifyPass(o.modelValue)&&(a=3),a}));d((()=>({1:"pwd-strength-1",2:"pwd-strength-2",3:"pwd-strength-3"}[w.value])));const g=e=>{s("input",e),s("update:modelValue",e)},b=e=>{s("blur",e)};return(e,s)=>{const o=r,c=a,d=u;return i(),p(d,{class:"InputPwd",modelValue:t.modelValue,placeholder:t.placeholder,type:l.value,onBlur:b,onInput:g},{suffix:A((()=>[f(c,{class:"f-center p-5"},{default:A((()=>[f(c,{class:"m-l-10"},{default:A((()=>["password"==l.value?(i(),p(o,{key:0,name:"icon-invite_invisible",onClick:n})):(i(),m("img",{key:1,class:"w-32 h-32 pointer",src:v("data:image/webp;base64,UklGRoQBAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSAUBAAABgFXbdtzmQBAEQQiDmkEEoUwsBjaDlkHDQGJgM7AZ2AxexquXdPqNCAVu2yjNMe7wEfz/xLcr8Vkdh2IPlP7oH3dYrMHSR4/CYC760NT7Zk621NCHKeZaZ1MMstlkj9pzBIh5t0em4PFzEDbPDic94HLlTlnVBiAVs6/u5lRlBjpTZqidzA3D7QCLUoBkD3QQlQpJzqr36ATISbuiVAFlBVBlVF+lKjMTMOvMJDOsr2mywkEpA5/egRpmbAHoqtnp7ny3huEwN6px3TbfVXNeSofb+vv73G+eu3u/a6pBKZMpxtZ7283Jntrvd/QpBxzEvLa05oiXNFZxkXJ6+r/qrkT+fQAAVlA4IFgAAABQAwCdASooACgAPp1Am0kiCIuKACwE4lnAMzQKEviIZQMPAAD+6Vb/+lH//SVX//SBZoLhDPAp+Xxg///YGpgNPBdRsq2XDv///9gXE8OrWoHQ3/XZAAAA"),onClick:n},null,8,R))])),_:1})])),_:1})])),_:1},8,["modelValue","placeholder","type"])}}},S=["src"],M={__name:"PictureCode",props:{account:{default:""},loading:{default:!1}},emits:["submit","cancel"],setup(e,{expose:o,emit:l}){const n=e,r=c("");let d=c("");const v=c(!0),C=encodeURIComponent(`account=${n.account}&type=math`),k=c(`${t}/user/downFile/captchaImage?${C}`);let B=c();const _=async()=>{const e=await j({method:"GET",url:k.value,responseType:"blob"}),a=await(t=e.data,new Promise(((e,a)=>{var s=new FileReader;s.onload=function(a){e(a.target.result)},s.readAsDataURL(t)})));var t;B.value=a,console.log("imageData",a)};o({getImage:_,clear:()=>{d.value=""},focus:()=>{r.value.focus()}});const x=()=>{l("submit",d.value)};return w((()=>{_()})),(t,o)=>{const l=u,n=a,c=s,w=E;return i(),p(c,{class:"w-100b p-lr-30"},{default:A((()=>[f(c,{class:"w-100b border-box"},{default:A((()=>[f(l,{ref_key:"inputRef",ref:r,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=e=>d.value=e),maxlength:"6",class:"h-100 w-100b",onInput:o[1]||(o[1]=e=>d.value=e.replace(/[^0-9]/g,""))},{suffix:A((()=>[v.value?(i(),m("img",{key:0,class:"w-220 h-80",src:B.value},null,8,S)):g("",!0)])),_:1},8,["modelValue"]),f(n,{class:"w-100b m-t-20 c-info h-10 font-18 pointer font-24 underline",x:"e",y:"c"},{default:A((()=>[f(n,{onClick:_},{default:A((()=>[b(h(t.$t("user.dontsee")),1)])),_:1}),y("img",{src:"data:image/webp;base64,UklGRlwBAABXRUJQVlA4WAoAAAAQAAAAHwAAHwAAQUxQSOoAAAABgJPtf9zmB0EQBEEAeghAD28dIwYxg2bMVjOIAfRi4DBI9l7eOkpTx36D5EMMImICNNNu34YIw7B1WtMPzP3ZFMy9nbADS09O0plYchFg7FvvfehG8iABPgsAZ69pdwR4mjIAreY3CQgTSqRGS91IsWB3TstdmrOyr6a+mq2m92ptNZ8d/z/WM8DNP1ysJuABaNf74E/Afj1dKHuuoMJvNVy1oRpNtehqcXKLzBthag9Ev8CdgCnfARzsDPMYgX6GAvnb9tpI15tDBOhUHMFIfmRpCir7rlG+S/N2RstN06dCeg9WqxtvtRRWUDggTAAAADAEAJ0BKiAAIAA+nUicSyITU1QFVFgJxLGAWnQ0r+AygJAw04NHtlv3AAD+0soP+ucO1JqgDf4/dtOkbjMsZkF8tQLW4y4Km1aAAAA=",class:"w-24 h-24 m-l-8",onClick:_})])),_:1})])),_:1}),f(n,{class:"w-100b m-t-48"},{default:A((()=>[f(w,{disabled:!d.value,loading:e.loading,type:"primary",class:"w-100b font-32 h-98 font-w-400",onClick:x},{default:A((()=>[b(h(t.$t("alert.confirm")),1)])),_:1},8,["disabled","loading"])])),_:1})])),_:1})}}},U={key:0},F={class:"p-r-2 c-primary"},J={class:"c-info"},Z={key:1},q={class:"m-r-8 c-info"},z={class:"p-r-2 c-primary"},T={key:1,class:"font-28"},X={__name:"CodeButton",props:{isAbsolute:{default:!0},getVerifyCode:{default:async()=>{}},autoSend:{default:!1},beforeClick:{default:()=>async()=>!0},account:{},type:{require:!0},phoneAreaCode:{default:""}},setup(e,{emit:t}){const s=e,u=c("");let d=c(!1),v=c(!1),w=c(!1);const j=C({show:!1}),R=o;let N=c(R);const S=async()=>{if(!1===await s.beforeClick())return;const e={phoneOrEmail:s.account,type:s.type,phoneAreaCode:s.phoneAreaCode};try{v.value=!0;const a=await l.kaptchaIsNeed(e);if(d.value=a,a)return void(j.show=!0);await X()}catch(a){}finally{v.value=!1}},X=async(e={})=>{const a={phoneOrEmailStr:s.account,smsType:s.type,phoneAreaCode:s.phoneAreaCode,need:d.value};d.value&&(a.captcha=e.captcha);try{await l.sendCorgotPasswordCode(a)}catch(t){return 15524===t.code&&u.value.getImage(),u.value.clear(),void u.value.focus()}j.show=!1,D.success($t("alert.verificationCodeSent")),w.value=!0,N.value=R,n((()=>(N.value--,0!=N.value)),1e3)},H=async e=>{try{v.value=!0,await X({captcha:e})}catch(a){}finally{v.value=!1}};return k((()=>N.value),(e=>{0==e&&(w.value=!1)})),B((()=>{_((()=>{s.autoSend&&S()}))})),(t,s)=>{const o=a,l=E,n=r,c=M,d=P,C=V;return i(),m(Q,null,[f(l,x(t.$attrs,{class:["CodeButton h-auto p-lr-20",e.isAbsolute?"CodeButton-absolute p-lr-10 m-l-10":""],link:"",type:"primary",loading:v.value,disabled:w.value,onClick:I(S,["stop"])}),{default:A((()=>[w.value?(i(),p(o,{key:0,class:"font-28"},{default:A((()=>["zh"===t.lang()?(i(),m("div",U,[y("span",F,h(N.value)+"s",1),y("span",J,h(t.$t("form.verifyCodeResendNew")),1)])):(i(),m("div",Z,[y("span",q,h(t.$t("form.verifyCodeResendNew")),1),y("span",z,h(N.value)+"s",1)]))])),_:1})):g("",!0),w.value?g("",!0):(i(),m("span",T,h(t.$t("form.getVerifyCode")),1))])),_:1},16,["class","loading","disabled","onClick"]),f(C,{show:j.show,"onUpdate:show":s[2]||(s[2]=e=>j.show=e),position:"bottom",teleport:"body"},{default:A((()=>[f(o,{class:"c-info w-100b p-lr-30 h-110 bg-d",x:"sb"},{default:A((()=>[f(o,{class:"c-dark bold font-36"},{default:A((()=>[b(h(t.$t("user.safetyVerify")),1)])),_:1}),f(n,{name:"icon-invite_close",class:"font-24",onClick:s[0]||(s[0]=e=>j.show=!1)})])),_:1}),f(d,null,{default:A((()=>[j.show?(i(),p(c,{key:0,ref_key:"PCref",ref:u,class:"p-b-30 m-t-60",account:e.account,loading:v.value,onSubmit:H,onCancel:s[1]||(s[1]=e=>j.show=!1)},null,8,["account","loading"])):g("",!0)])),_:1})])),_:1},8,["show"])],64)}}};export{X as _,N as a};
//# sourceMappingURL=CodeButton-ef9a3497.js.map
