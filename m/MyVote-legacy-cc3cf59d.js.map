{"version":3,"file":"MyVote-legacy-cc3cf59d.js","sources":["../../src/view/vote/MyVote.vue"],"sourcesContent":["<template>\n  <Page\n    v-model:isRefresh=\"isRefresh\"\n    :title=\"$t('vote.myVote')\"\n    hideHeader\n    :openRefresh=\"true\"\n    :onRefresh=\"onRefresh\"\n    :onClickLeft=\"onClickLeft\"\n    bodyClass=\"bg-white\"\n  >\n    <van-list\n      v-model:loading=\"loading\"\n      class=\"w-100b f-1\"\n      :finished=\"finished\"\n      :finished-text=\"$t('form.noMoreData')\"\n      :loading-text=\"$t('form.loading')\"\n      @refresh=\"onRefresh\"\n      @load=\"onLoad\"\n    >\n      <Column v-for=\"(row) in list\" :key=\"row\" class=\"w-100b p-30 p-b-0\">\n        <Row class=\"w-100b m-b-20\" x=\"sb\" y=\"s\">\n          <Row>\n            <img class=\"w-40 h-40 m-r-10\" :src=\"row.iconUrl\" alt=\"\">\n            <span class=\"label-lg bold\">{{ row.coinName }}</span>\n          </Row>\n          <span class=\"label-sm c-info\">{{ dayjs(row.recordTime).format('YYYY-MM-DD HH:mm:ss') }}</span>\n        </Row>\n        <Row class=\"w-100b label-sm  m-b-10\" x=\"sb\" y=\"s\">\n          <span class=\"c-info\">{{ $t('vote.inTheEnd') }}</span>\n          <span class=\"bold\">{{ voteResultOptions.find(e => row.voteResult == e.value)?.label }}</span>\n        </Row>\n        <Row class=\"w-100b label-sm  m-b-10\" x=\"sb\" y=\"s\">\n          <span class=\"c-info\">{{ $t('table.number') }}</span>\n          <span class=\"bold\">\n            <Num>{{ row.voteAmount }}</Num>\n            <span class=\"m-l-4\">{{ row.type != 2 ? 'BFT' : row.coinName }} </span>\n          </span>\n        </Row>\n        <Row class=\"w-100b label-sm \" x=\"sb\" y=\"s\">\n          <span class=\"c-info\">{{ $t('public.type') }}</span>\n          <span class=\"bold\">{{ typetOptions.find(e => row.type == e.value)?.label }}</span>\n        </Row>\n        <div class=\"w-100b border-b m-t-30\" />\n      </Column>\n    </van-list>\n  </Page>\n</template>\n\n<script setup>\nimport { VoteList, FinishedList, DiaCoinApplication } from '@/view/vote/components'\n\nconst languageStore = useLanguageStore()\nconst route = useRoute()\n\nconst onClickLeft = () => {\n  router.go(-1)\n}\n\nlet loading = $ref(false)\nlet isRefresh = $ref(false)\nlet list = $ref([])\nlet total = $ref()\n\nconst pages = reactive({\n  ...PAGES,\n  // pageNum: 1,\n  // pageSize: 1000,\n})\n\nconst voteResultOptions = $computed(() => [\n  { label: $t('public.success'), value: 1 },\n  { label: $t('public.failure'), value: 0 },\n])\n\nconst typetOptions = $computed(() => [\n  { label: $t('vote.typeMap.0'), value: 0 },\n  { label: $t('vote.typeMap.1'), value: 1 },\n  { label: $t('vote.typeMap.2'), value: 2 },\n  { label: $t('vote.typeMap.3'), value: 3 },\n])\n\nconst finished = $computed(() => {\n  if (loading == true) {\n    return true\n  } else if (list?.length == total) {\n    return true\n  } else {\n    return false\n  }\n})\n\nconst getData = async () => {\n  try {\n    loading = true\n    const body = {\n      activityId: route.query.activityId,\n      ...pages,\n    }\n    const d = await voteApi.history(body)\n    const ls = d.records?.map((e, i) => ({ ...e, index: i + 1 })) ?? []\n    if (isArray(list)) {\n      list.push(...ls)\n    } else {\n      list = ls\n    }\n    total = d.total\n  } finally {\n    loading = false\n  }\n}\n\nconst onRefresh = async () => {\n  try {\n    isRefresh = true\n    pages.pageNum = 1\n    const body = {\n      activityId: route.query.activityId,\n      ...pages,\n    }\n    const d = await voteApi.history(body)\n    list = d.records?.map((e, i) => ({ ...e, index: i + 1 })) ?? []\n    total = d.total\n  } finally {\n    isRefresh = false\n  }\n}\n\nconst onLoad = () => {\n  pages.pageNum = pages.pageNum + 1\n  getData()\n}\n// winMes.postParent('hiddenNaviBar')\n\nonBeforeMount(() => {\n  onRefresh()\n})\n\nonMounted(() => {})\n</script>\n\n<style lang=\"scss\">\n.MyVote {  }\n</style>\n"],"names":["useLanguageStore","route","useRoute","onClickLeft","router","go","loading","_ref","isRefresh","list","total","pages","reactive","PAGES","_computed","label","$t","value","typetOptions","finished","length","onRefresh","async","pageNum","body","activityId","query","history","d","records","_d$records2","map","e","i","index","_d$records$map2","onLoad","voteApi","_d$records","isArray","push","ls","getData","onBeforeMount","onMounted"],"mappings":"gsCAmDAA,IACA,MAAAC,EAAAC,IAEAC,EAAA,KACAC,EAAAC,IAAA,EACA,EAEA,IAAAC,EAAAC,GAAA,GACAC,EAAAD,GAAA,GACAE,EAAAF,EAAA,IACAG,EAAAH,IAEA,MAAAI,EAAAC,EAAA,IACAC,MAKAC,GAAA,IAAA,CACA,CAAAC,MAAAC,GAAA,kBAAAC,MAAA,GACA,CAAAF,MAAAC,GAAA,kBAAAC,MAAA,MAGAC,EAAAJ,GAAA,IAAA,CACA,CAAAC,MAAAC,GAAA,kBAAAC,MAAA,GACA,CAAAF,MAAAC,GAAA,kBAAAC,MAAA,GACA,CAAAF,MAAAC,GAAA,kBAAAC,MAAA,GACA,CAAAF,MAAAC,GAAA,kBAAAC,MAAA,MAGAE,EAAAL,GAAA,WACA,OAAA,GAAAR,EAAAW,QAEAG,UAAAX,EAAAQ,aAAAG,IAAAA,OAAAA,EAAAA,EAAAA,SAAAV,EAAAO,KAIA,IAuBAI,EAAAC,UACA,YACAd,EAAAS,OAAA,EACAN,EAAAY,QAAA,EACA,MAAAC,EAAA,CACAC,WAAAxB,EAAAyB,MAAAD,cACAd,aAEAgB,QAAAH,GACAf,EAAAQ,MAAA,QAAAW,EAAA,QAAAA,EAAAA,EAAAC,eAAA,IAAAC,OAAA,EAAAA,EAAAC,KAAA,CAAAC,EAAAC,KAAA,IAAAD,EAAAE,MAAAD,EAAA,aAAA,IAAAE,EAAAA,EAAA,GACAzB,EAAAO,MAAAW,EAAAlB,KAGA,CAZA,QAWAF,EAAAS,OAAA,CACA,GAGAmB,EAAA,KACAzB,EAAAY,QAAAZ,EAAAY,QAAA,EArCAD,WACA,IACAhB,IAAAA,EAAAA,EAAAA,EAAAW,OAAA,EACA,QAAA,CACAQ,WAAAxB,EAAAyB,MAAAD,cACAd,GAEAiB,QAAAS,EAAAV,QAAAH,aACAI,UAAAA,EAAAA,EAAAC,4BAAAS,EAAAP,KAAA,CAAAC,EAAAC,KAAA,IAAAD,EAAAE,MAAAD,EAAA,qBAAA,GACAM,EAAA9B,EAAAQ,OACAR,EAAAQ,MAAAuB,QAAAC,GAEAhC,EAAAQ,MAAAwB,EAEA/B,EAAAO,MAAAW,EAAAlB,KAGA,CAhBA,QAeAJ,EAAAW,OAAA,CACA,GAqBAyB,EAAA;OAIAC,GAAA,KACAtB,GACA,IAEAuB,GAAA"}