import{b as e,e as l,_ as a,w as t,d as r}from"./index-8763a24f.js";import{h as s,b as i,g as o,f as n,a as u}from"./index-ee5248b7.js";import{aa as d,Y as v,r as c,c as p,k as f,w as m,p as h,a as g,H as b,M as y,N as w,O as S,P as j,u as W,ad as k,i as F,b as x,l as q,B,j as I,F as M,n as $,aj as A,S as E,R as L,y as P,U as O,Q as _,W as R,$ as C,Z as V,T as z}from"./vue-10f3042e.js";import{p as N,u as T,x as G,b as H,y as Q}from"./index-dea076ad.js";import{c as U,a as Y}from"./lodash-es-87d81e2d.js";import{d as Z,t as D}from"./error-e384bc30.js";import{S as J}from"./async-validator-58962fa7.js";import{u as K}from"./index-5cef0a1f.js";const X=e({model:Object,rules:{type:l(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},size:{type:String,values:s},disabled:Boolean,validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:Boolean}),ee={validate:(e,l,a)=>(d(e)||v(e))&&N(l)&&v(a)};function le(){const e=c([]),l=p((()=>{if(!e.value.length)return"0";const l=Math.max(...e.value);return l?`${l}px`:""}));function a(a){const t=e.value.indexOf(a);return-1===t&&l.value,t}return{autoLabelWidth:l,registerLabelWidth:function(l,t){if(l&&t){const r=a(t);e.value.splice(r,1,l)}else l&&e.value.push(l)},deregisterLabelWidth:function(l){const t=a(l);t>-1&&e.value.splice(t,1)}}}const ae=(e,l)=>{const a=U(l);return a.length>0?e.filter((e=>e.prop&&a.includes(e.prop))):e},te=f({name:"ElForm"});var re=a(f({...te,props:X,emits:ee,setup(e,{expose:l,emit:a}){const t=e,r=[],s=i(),n=T("form"),u=p((()=>{const{labelPosition:e,inline:l}=t;return[n.b(),n.m(s.value||"default"),{[n.m(`label-${e}`)]:e,[n.m("inline")]:l}]})),d=(e=[])=>{t.model&&ae(r,e).forEach((e=>e.resetField()))},v=(e=[])=>{ae(r,e).forEach((e=>e.clearValidate()))},c=p((()=>!!t.model)),f=async e=>x(void 0,e),F=async(e=[])=>{if(!c.value)return!1;const l=(e=>{if(0===r.length)return[];const l=ae(r,e);return l.length?l:[]})(e);if(0===l.length)return!0;let a={};for(const r of l)try{await r.validate("")}catch(t){a={...a,...t}}return 0===Object.keys(a).length||Promise.reject(a)},x=async(e=[],l)=>{const a=!k(l);try{const a=await F(e);return!0===a&&(null==l||l(a)),a}catch(r){if(r instanceof Error)throw r;const e=r;return t.scrollToError&&q(Object.keys(e)[0]),null==l||l(!1,e),a&&Promise.reject(e)}},q=e=>{var l;const a=ae(r,e)[0];a&&(null==(l=a.$el)||l.scrollIntoView())};return m((()=>t.rules),(()=>{t.validateOnRuleChange&&f().catch((e=>Z()))}),{deep:!0}),h(o,g({...b(t),emit:a,resetFields:d,clearValidate:v,validateField:x,addField:e=>{r.push(e)},removeField:e=>{e.prop&&r.splice(r.indexOf(e),1)},...le()})),l({validate:f,validateField:x,resetFields:d,clearValidate:v,scrollToField:q}),(e,l)=>(y(),w("form",{class:j(W(u))},[S(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);const se=e({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:l([String,Array])},required:{type:Boolean,default:void 0},rules:{type:l([Object,Array])},error:String,validateStatus:{type:String,values:["","error","validating","success"]},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:s}});var ie=f({name:"ElLabelWrap",props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:l}){const a=F(o,void 0),t=F(n);t||D("ElLabelWrap","usage: <el-form-item><label-wrap /></el-form-item>");const r=T("form"),s=c(),i=c(0),u=(t="update")=>{$((()=>{l.default&&e.isAutoWidth&&("update"===t?i.value=(()=>{var e;if(null==(e=s.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(s.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0})():"remove"===t&&(null==a||a.deregisterLabelWidth(i.value)))}))},d=()=>u("update");return x((()=>{d()})),q((()=>{u("remove")})),B((()=>d())),m(i,((l,t)=>{e.updateAll&&(null==a||a.registerLabelWidth(l,t))})),K(p((()=>{var e,l;return null!=(l=null==(e=s.value)?void 0:e.firstElementChild)?l:null})),d),()=>{var o,n;if(!l)return null;const{isAutoWidth:u}=e;if(u){const e=null==a?void 0:a.autoLabelWidth,n={};if((null==t?void 0:t.hasLabel)&&e&&"auto"!==e){const l=Math.max(0,Number.parseInt(e,10)-i.value),t="left"===a.labelPosition?"marginRight":"marginLeft";l&&(n[t]=`${l}px`)}return I("div",{ref:s,class:[r.be("item","label-wrap")],style:n},[null==(o=l.default)?void 0:o.call(l)])}return I(M,{ref:s},[null==(n=l.default)?void 0:n.call(l)])}}});const oe=["role","aria-labelledby"],ne=f({name:"ElFormItem"});var ue=a(f({...ne,props:se,setup(e,{expose:l}){const a=e,t=A(),r=F(o,void 0),s=F(n,void 0),d=i(void 0,{formItem:!1}),f=T("form-item"),B=u().value,M=c([]),Z=c(""),D=G(Z,100),K=c(""),X=c();let ee,le=!1;const ae=p((()=>{if("top"===(null==r?void 0:r.labelPosition))return{};const e=H(a.labelWidth||(null==r?void 0:r.labelWidth)||"");return e?{width:e}:{}})),te=p((()=>{if("top"===(null==r?void 0:r.labelPosition)||(null==r?void 0:r.inline))return{};if(!a.label&&!a.labelWidth&&pe)return{};const e=H(a.labelWidth||(null==r?void 0:r.labelWidth)||"");return a.label||t.label?{}:{marginLeft:e}})),re=p((()=>[f.b(),f.m(d.value),f.is("error","error"===Z.value),f.is("validating","validating"===Z.value),f.is("success","success"===Z.value),f.is("required",ge.value||a.required),f.is("no-asterisk",null==r?void 0:r.hideRequiredAsterisk),"right"===(null==r?void 0:r.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[f.m("feedback")]:null==r?void 0:r.statusIcon}])),se=p((()=>N(a.inlineMessage)?a.inlineMessage:(null==r?void 0:r.inlineMessage)||!1)),ne=p((()=>[f.e("error"),{[f.em("error","inline")]:se.value}])),ue=p((()=>a.prop?v(a.prop)?a.prop:a.prop.join("."):"")),de=p((()=>!(!a.label&&!t.label))),ve=p((()=>a.for||1===M.value.length?M.value[0]:void 0)),ce=p((()=>!ve.value&&de.value)),pe=!!s,fe=p((()=>{const e=null==r?void 0:r.model;if(e&&a.prop)return Q(e,a.prop).value})),me=p((()=>{const{required:e}=a,l=[];a.rules&&l.push(...U(a.rules));const t=null==r?void 0:r.rules;if(t&&a.prop){const e=Q(t,a.prop).value;e&&l.push(...U(e))}if(void 0!==e){const a=l.map(((e,l)=>[e,l])).filter((([e])=>Object.keys(e).includes("required")));if(a.length>0)for(const[t,r]of a)t.required!==e&&(l[r]={...t,required:e});else l.push({required:e})}return l})),he=p((()=>me.value.length>0)),ge=p((()=>me.value.some((e=>e.required)))),be=p((()=>{var e;return"error"===D.value&&a.showMessage&&(null==(e=null==r?void 0:r.showMessage)||e)})),ye=p((()=>`${a.label||""}${(null==r?void 0:r.labelSuffix)||""}`)),we=e=>{Z.value=e},Se=async e=>{const l=ue.value;return new J({[l]:e}).validate({[l]:fe.value},{firstFields:!0}).then((()=>(we("success"),null==r||r.emit("validate",a.prop,!0,""),!0))).catch((e=>((e=>{var l,t;const{errors:s,fields:i}=e;s&&i||console.error(e),we("error"),K.value=s?null!=(t=null==(l=null==s?void 0:s[0])?void 0:l.message)?t:`${a.prop} is required`:"",null==r||r.emit("validate",a.prop,!1,K.value)})(e),Promise.reject(e))))},je=async(e,l)=>{if(le||!a.prop)return!1;const t=k(l);if(!he.value)return null==l||l(!1),!1;const r=(e=>me.value.filter((l=>!l.trigger||!e||(Array.isArray(l.trigger)?l.trigger.includes(e):l.trigger===e))).map((({trigger:e,...l})=>l)))(e);return 0===r.length?(null==l||l(!0),!0):(we("validating"),Se(r).then((()=>(null==l||l(!0),!0))).catch((e=>{const{fields:a}=e;return null==l||l(!1,a),!t&&Promise.reject(a)})))},We=()=>{we(""),K.value="",le=!1},ke=async()=>{const e=null==r?void 0:r.model;if(!e||!a.prop)return;const l=Q(e,a.prop);le=!0,l.value=Y(ee),await $(),We(),le=!1};m((()=>a.error),(e=>{K.value=e||"",we(e?"error":"")}),{immediate:!0}),m((()=>a.validateStatus),(e=>we(e||"")));const Fe=g({...b(a),$el:X,size:d,validateState:Z,labelId:B,inputIds:M,isGroup:ce,hasLabel:de,addInputId:e=>{M.value.includes(e)||M.value.push(e)},removeInputId:e=>{M.value=M.value.filter((l=>l!==e))},resetField:ke,clearValidate:We,validate:je});return h(n,Fe),x((()=>{a.prop&&(null==r||r.addField(Fe),ee=Y(fe.value))})),q((()=>{null==r||r.removeField(Fe)})),l({size:d,validateMessage:K,validateState:Z,validate:je,clearValidate:We,resetField:ke}),(e,l)=>{var a;return y(),w("div",{ref_key:"formItemRef",ref:X,class:j(W(re)),role:W(ce)?"group":void 0,"aria-labelledby":W(ce)?W(B):void 0},[I(W(ie),{"is-auto-width":"auto"===W(ae).width,"update-all":"auto"===(null==(a=W(r))?void 0:a.labelWidth)},{default:E((()=>[W(de)?(y(),L(R(W(ve)?"label":"div"),{key:0,id:W(B),for:W(ve),class:j(W(f).e("label")),style:_(W(ae))},{default:E((()=>[S(e.$slots,"label",{label:W(ye)},(()=>[P(O(W(ye)),1)]))])),_:3},8,["id","for","class","style"])):C("v-if",!0)])),_:3},8,["is-auto-width","update-all"]),V("div",{class:j(W(f).e("content")),style:_(W(te))},[S(e.$slots,"default"),I(z,{name:`${W(f).namespace.value}-zoom-in-top`},{default:E((()=>[W(be)?S(e.$slots,"error",{key:0,error:K.value},(()=>[V("div",{class:j(W(ne))},O(K.value),3)])):C("v-if",!0)])),_:3},8,["name"])],6)],10,oe)}}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const de=t(re,{FormItem:ue}),ve=r(ue);export{ve as E,de as a};
//# sourceMappingURL=index-81717dbd.js.map
