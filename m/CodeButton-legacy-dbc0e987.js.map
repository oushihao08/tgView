{"version":3,"file":"CodeButton-legacy-dbc0e987.js","sources":["../../src/image/invisible.webp","../../src/components/form/InputPwd.vue","../../src/components/form/PictureCode.vue","../../src/image/user/reSend.webp","../../src/components/form/CodeButton.vue"],"sourcesContent":["export default \"data:image/webp;base64,UklGRoQBAABXRUJQVlA4WAoAAAAQAAAAJwAAJwAAQUxQSAUBAAABgFXbdtzmQBAEQQiDmkEEoUwsBjaDlkHDQGJgM7AZ2AxexquXdPqNCAVu2yjNMe7wEfz/xLcr8Vkdh2IPlP7oH3dYrMHSR4/CYC760NT7Zk621NCHKeZaZ1MMstlkj9pzBIh5t0em4PFzEDbPDic94HLlTlnVBiAVs6/u5lRlBjpTZqidzA3D7QCLUoBkD3QQlQpJzqr36ATISbuiVAFlBVBlVF+lKjMTMOvMJDOsr2mywkEpA5/egRpmbAHoqtnp7ny3huEwN6px3TbfVXNeSofb+vv73G+eu3u/a6pBKZMpxtZ7283Jntrvd/QpBxzEvLa05oiXNFZxkXJ6+r/qrkT+fQAAVlA4IFgAAABQAwCdASooACgAPp1Am0kiCIuKACwE4lnAMzQKEviIZQMPAAD+6Vb/+lH//SVX//SBZoLhDPAp+Xxg///YGpgNPBdRsq2XDv///9gXE8OrWoHQ3/XZAAAA\"","<!--\n * @Author: ken yang\n * @Date: 2023-05-07 11:52:51\n * @LastEditTime: 2023-07-31 13:35:31\n * @LastEditors: ken yang\n * @Description:\n * @FilePath: /uexch_h5/src/components/form/InputPwd.vue\n-->\n<template>\n  <el-input\n    class=\"InputPwd\"\n    :modelValue=\"modelValue\"\n    :placeholder=\"placeholder\"\n    :type=\"type\"\n    @blur=\"onBlur\"\n    @input=\"onInput\"\n  >\n    <template #suffix>\n      <Row class=\"f-center p-5\">\n        <Row class=\"m-l-10\">\n          <IconSvg v-if=\"type == 'password'\" :name=\"'icon-invite_invisible'\" @click=\"switchType\" />\n          <img\n            v-else\n            class=\"w-32 h-32 pointer\"\n            :src=\"invisibleImage\"\n            @click=\"switchType\"\n          >\n        </Row>\n      </Row>\n    </template>\n  </el-input>\n</template>\n\n<script setup>\nimport visibleImage from '@/image/visible.webp'\nimport invisibleImage from '@/image/invisible.webp'\n\nconst props = defineProps({\n  modelValue: {},\n  placeholder: {},\n  showPwdStrengt: {\n    default: true\n  },\n  pwdStrengt: {}\n})\n\nconst emit = defineEmits()\n\nlet type = $ref('password')\nconst switchType = () => {\n  type = type == 'password' ? 'text' : 'password'\n}\n\nconst pwdStrengthState = $computed(() => {\n  let state = 1\n  if ($v.pwdStrengt.verifyPass(props.modelValue)) {\n    state = 3\n  }\n  return state\n})\n\nconst pwdStrengthImage = $computed(() => {\n  const map = {\n    1: 'pwd-strength-1',\n    2: 'pwd-strength-2',\n    3: 'pwd-strength-3',\n  }\n  return map[pwdStrengthState]\n})\nconst onInput = v => {\n  emit('input', v)\n  emit('update:modelValue', v)\n}\n\nconst onBlur = v => {\n  emit('blur', v)\n}\n</script>\n\n<style lang=\"scss\">\n.InputPwd {\n  // .el-input__suffix-inner{\n\n  // }\n  .el-input__icon {\n    display: none !important;\n  }\n  .password-show-image {\n    width: 20px;\n    height: 20px;\n  }\n  .pwd-strength-image {\n    width: 16px;\n    height: 4px;\n  }\n}\n</style>\n\n","\n<template>\n  <Column class=\"w-100b p-lr-30\">\n    <!-- <Row class=\"m-b-10 c-info\">{{ $t('user.plsInputSV') }}</Row> -->\n    <Column class=\"w-100b border-box\">\n      <el-input\n        ref=\"inputRef\"\n        v-model=\"value\"\n        maxlength=\"6\"\n        class=\"h-100 w-100b\"\n        @input=\"(val)=>value = val.replace(/[^0-9]/g, '')\"\n      >\n        <template #suffix>\n          <img v-if=\"reload\" class=\"w-220 h-80\" :src=\"imageData\">\n        </template>\n      </el-input>\n      <Row class=\"w-100b m-t-20 c-info h-10 font-18 pointer font-24 underline\" x=\"e\" y=\"c\">\n        <Row @click=\"getImage\">{{ $t('user.dontsee') }}</Row>\n        <img src=\"@/image/user/reSend.webp\" class=\"w-24 h-24 m-l-8\" @click=\"getImage\">\n      </Row>\n    </Column>\n\n    <Row class=\"w-100b m-t-48\">\n      <el-button\n        :disabled=\"!value\"\n        :loading=\"loading\"\n        type=\"primary\"\n        class=\" w-100b font-32 h-98 font-w-400\"\n        @click=\"submit\"\n      >{{ $t('alert.confirm') }}</el-button>\n    </Row>\n  </Column>\n</template>\n<script setup>\nconst emit = defineEmits(['submit', 'cancel'])\nconst props = defineProps({\n  account: {\n    default: ''\n  },\n  loading: {\n    default: false\n  }\n})\nconst inputRef = $ref('')\nlet value = $ref('')\nconst reload = $ref(true)\nconst query = encodeURIComponent(`account=${props.account}&type=math`)\nconst rowUrl = `${serveUrl}/user/downFile/captchaImage?${query}`\nconst url = $ref(rowUrl)\n\nlet imageData = $ref()\n\nfunction blobToDataURI (blob) {\n  return new Promise((resolve, reject) => {\n    var reader = new FileReader()\n    reader.onload = function (e) {\n      resolve(e.target.result)\n    }\n    reader.readAsDataURL(blob)\n  })\n}\n\nconst getImage = async () => {\n  const res = await axios({\n    method: 'GET',\n    url: url,\n    responseType: 'blob', // 注意这里的返回值类型为：arraybuffer\n  })\n\n  // const d = URL.createObjectURL(res.data)\n  const d = await blobToDataURI(res.data)\n\n  imageData = d\n  console.log('imageData', d)\n}\n\ndefineExpose({\n  getImage: getImage,\n  clear: () => {\n    value = ''\n  },\n  focus: () => {\n    inputRef.focus()\n  }\n})\n\nconst submit = () => {\n  emit('submit', value)\n}\n\nonBeforeMount(() => {\n  getImage()\n})\n\n</script>\n<style lang=\"scss\">\n.pc-radius-lb{\n  border-radius: 0px 0px 0px 20px;\n  background: #F7F9FC !important;\n  border:none\n}\n\n.pc-radius-rb{\n  border-radius: 0px 0px 20px 0px;\n}\n.underline{\n  text-decoration: underline;\n}\n</style>\n","export default \"data:image/webp;base64,UklGRlwBAABXRUJQVlA4WAoAAAAQAAAAHwAAHwAAQUxQSOoAAAABgJPtf9zmB0EQBEEAeghAD28dIwYxg2bMVjOIAfRi4DBI9l7eOkpTx36D5EMMImICNNNu34YIw7B1WtMPzP3ZFMy9nbADS09O0plYchFg7FvvfehG8iABPgsAZ69pdwR4mjIAreY3CQgTSqRGS91IsWB3TstdmrOyr6a+mq2m92ptNZ8d/z/WM8DNP1ysJuABaNf74E/Afj1dKHuuoMJvNVy1oRpNtehqcXKLzBthag9Ev8CdgCnfARzsDPMYgX6GAvnb9tpI15tDBOhUHMFIfmRpCir7rlG+S/N2RstN06dCeg9WqxtvtRRWUDggTAAAADAEAJ0BKiAAIAA+nUicSyITU1QFVFgJxLGAWnQ0r+AygJAw04NHtlv3AAD+0soP+ucO1JqgDf4/dtOkbjMsZkF8tQLW4y4Km1aAAAA=\"","\n<template>\n  <el-button\n    v-bind=\"$attrs\"\n    class=\" CodeButton h-auto p-lr-20\"\n    :class=\"isAbsolute ? 'CodeButton-absolute p-lr-10 m-l-10' : ''\"\n    link\n    type=\"primary\"\n    :loading=\"loading\"\n    :disabled=\"disabled\"\n    @click.stop=\"click\"\n  >\n    <Row v-if=\"disabled\" class=\"font-28\">\n      <div v-if=\"lang()==='zh'\">\n        <span class=\"p-r-2 c-primary\">{{ time }}s</span>\n        <span class=\"c-info\">{{ $t('form.verifyCodeResendNew') }}</span>\n      </div>\n      <div v-else>\n        <span class=\"m-r-8 c-info\">{{ $t('form.verifyCodeResendNew') }}</span>\n        <span class=\"p-r-2 c-primary\">{{ time }}s</span>\n      </div>\n    </Row>\n    <span v-if=\"!disabled\" class=\"font-28\">{{ $t('form.getVerifyCode') }}</span>\n  </el-button>\n\n  <van-popup v-model:show=\"picCodeDetail.show\" position=\"bottom\" teleport=\"body\">\n    <Row class=\"c-info w-100b p-lr-30 h-110 bg-d\" x=\"sb\">\n      <Row class=\"c-dark bold font-36\">{{ $t('user.safetyVerify') }}</Row>\n      <IconSvg name=\"icon-invite_close\" class=\"font-24\" @click=\"picCodeDetail.show = false\" />\n    </Row>\n    <!-- <Row class=\"24 p-l-30 font-24 m-t-60 m-b-14\">图像验证码</Row> -->\n    <el-form-item>\n      <PictureCode\n        v-if=\"picCodeDetail.show\"\n        ref=\"PCref\"\n        class=\"p-b-30 m-t-60\"\n        :account=\"account\"\n        :loading=\"loading\"\n        @submit=\"picCodeSubmit\"\n        @cancel=\"picCodeDetail.show=false\"\n      />\n    </el-form-item>\n\n  </van-popup>\n</template>\n\n<script setup>\nconst emit = defineEmits()\nconst props = defineProps({\n  isAbsolute: { default: true },\n  getVerifyCode: {\n    default: async () => { }\n  },\n  autoSend: {\n    default: false,\n  },\n  beforeClick: {\n    default: () => { return async () => { return true } }\n  },\n  account: {},\n  type: {\n    require: true\n  },\n  phoneAreaCode: {\n    default: ''\n  }\n})\nconst PCref = $ref('')\nlet isPicCode = $ref(false)\nlet loading = $ref(false)\nlet disabled = $ref(false)\nconst picCodeDetail = reactive({\n  show: false\n})\n\nconst timeInitNum = COUNTDOWN\nlet time = $ref(timeInitNum)\n\nconst timing = () => {\n  disabled = true\n  time = timeInitNum\n  runTimer(() => {\n    time--\n    return time != 0\n  }, 1000)\n}\n\nconst click = async () => {\n  if (await props.beforeClick() === false) return\n  const body = {\n    phoneOrEmail: props.account,\n    type: props.type,\n    phoneAreaCode: props.phoneAreaCode\n  }\n  try {\n    loading = true\n    const data = await userApi.kaptchaIsNeed(body)\n    isPicCode = data\n    if (data) {\n      picCodeDetail.show = true\n      return\n    } else {\n      await submit()\n    }\n  } catch (error) {\n\n  } finally {\n    loading = false\n  }\n  return\n}\n\nconst submit = async (obj = {}) => {\n  const body = {\n    phoneOrEmailStr: props.account,\n    smsType: props.type,\n    phoneAreaCode: props.phoneAreaCode,\n    need: isPicCode\n  }\n  if (isPicCode) {\n    body.captcha = obj.captcha\n  }\n  try {\n    const res = await userApi.sendCorgotPasswordCode(body)\n  } catch (error) {\n    if (error.code === 15524) {\n      PCref.getImage()\n    }\n    PCref.clear()\n    PCref.focus()\n    return\n  }\n\n  picCodeDetail.show = false\n  ElMessage.success($t('alert.verificationCodeSent'))\n  // emit('emit', data)\n  timing()\n}\n\nconst picCodeSubmit = async (val) => {\n  try {\n    loading = true\n    await submit({ captcha: val })\n  } catch (error) {\n  } finally {\n    loading = false\n  }\n}\n\nwatch(\n  () => time,\n  v => {\n    if (v == 0) {\n      disabled = false\n    }\n  }\n)\n\nonMounted(() => {\n  nextTick(() => {\n    if (props.autoSend) {\n      click()\n    }\n  })\n})\n</script>\n\n<style lang=\"scss\">\n.CodeButton {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  background-color: transparent;\n  border-width: 0px !important;\n  --el-color-primary-light-5: #2649EF;\n}\n.CodeButton-absolute{\n  min-width: 100px;\n  position: absolute !important;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n.pic-code-dia{\n  .el-dialog__body{\n    padding-left: 0px;\n    padding-right: 0px;\n    padding-bottom: 0px;\n    padding-top: 30px;\n  }\n}\n</style>\n\n"],"names":["type","_ref","switchType","value","pwdStrengthState","_computed","state","$v","pwdStrengt","verifyPass","props","modelValue","onInput","v","emit","onBlur","inputRef","reload","query","encodeURIComponent","account","url","serveUrl","imageData","getImage","async","res","axios","method","responseType","d","blob","data","Promise","resolve","reject","reader","FileReader","onload","e","target","result","readAsDataURL","console","log","expose","clear","focus","submit","onBeforeMount","PCref","isPicCode","loading","disabled","picCodeDetail","reactive","show","timeInitNum","COUNTDOWN","time","click","beforeClick","body","phoneOrEmail","phoneAreaCode","userApi","kaptchaIsNeed","error","obj","phoneOrEmailStr","smsType","need","captcha","sendCorgotPasswordCode","code","ElMessage","success","$t","runTimer","picCodeSubmit","val","watch","onMounted","nextTick","autoSend"],"mappings":"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"}